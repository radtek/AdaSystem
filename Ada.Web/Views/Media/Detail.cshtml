@using System.Web.Optimization
@using Ada.Core.Domain
@using Ada.Core.Infrastructure
@using Ada.Core.Tools
@using Ada.Core.ViewModel.Resource
@using Ada.Services.Business
@using Ada.Services.Resource
@model Ada.Core.Domain.Resource.Media
@{
    Layout = "~/Views/Shared/_Layout_Web.cshtml";
    ViewBag.Title = Model.MediaName + " 详情";

}

<div class="wrapper wrapper-content animated fadeInRight">
    <div class="row m-b-lg m-t-lg">
        <div class="col-md-6">

            <div class="profile-image">
                @if (string.IsNullOrWhiteSpace(Model.MediaLogo))
                {
                    <i class="fa @Model.MediaType.Image fa-5x"></i>
                }
                else
                {
                    <img src="@Model.MediaLogo" class="img-circle circle-border m-b-md" alt="profile">
                }
            </div>
            <div class="profile-info">
                <div class="">
                    <div>
                        <h2 class="no-margins">
                            @Model.MediaName

                        </h2>
                        @*@if (!string.IsNullOrWhiteSpace(Model.Area))
                            {
                                <small class='label label-info'><i class='fa fa-map-marker'></i> @Model.Area</small>
                            }*@
                        <h4>@Model.Abstract</h4>

                        <div class='p-xxs'>
                            @foreach (var tag in Model.MediaTags.Take(6))
                            {
                                <span class='label label-success'><i class='fa fa-tag'></i> @tag.TagName</span>
                            }
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <table class="table small m-b-xs">
                <tbody>
                    <tr>

                        <td>
                            <strong>@Utils.ShowFansNum(Model.FansNum)</strong> 粉丝数(万)
                        </td>
                        <td>
                            <strong>@Model.MediaPrices.Sum(d => d.BusinessOrderDetails.Count)</strong> 交易次数
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>



    </div>


    <div class="row">
        <div class="col-lg-12">
            <div class="ibox float-e-margins">
                <div class="ibox-title">
                    @{
                        var invalid = Model.MediaPrices.FirstOrDefault()?.InvalidDate?.ToString("yyyy-MM-dd");
                    }
                    <h3>资源报价 <small>价格有效期：@invalid</small></h3>

                </div>
                <div class="ibox-content">
                    <div class="row">
                        @foreach (var item in Model.MediaPrices)
                        {
                            <div class="col-lg-2">

                                <div class="widget  p-xs text-center">
                                    <div class="m-b-md">
                                        <h2 class="m-xs text-danger"><i class="fa fa-jpy"></i> @item.SellPrice</h2>
                                        <h3 class="font-bold no-margins">
                                            @item.AdPositionName
                                        </h3>
                                    </div>
                                </div>
                            </div>
                        }

                    </div>
                </div>
            </div>
        </div>
    </div>
    @if (Model.MediaArticles.Any())
    {
        if (Model.MediaType.CallIndex == "weixin")
        {
            @Html.Partial("WeiXinArticles", Model)
        }
        if (Model.MediaType.CallIndex == "sinablog")
        {
            @Html.Partial("WeiboArticles", Model)
        }
        if (Model.MediaType.CallIndex == "douyin")
        {
            @Html.Partial("DouYinArticles", Model)
        }

    }




</div>


@section Styles {
    @Styles.Render("~/plugins/footableV3Styles")
}
@section Scripts {
    @Scripts.Render("~/plugins/footableV3")
    @Scripts.Render("~/plugins/echarts")
    @Scripts.Render("~/plugins/tagcanvasScript")
    <script>

        @if (Model.MediaArticles.Any())
        {
            <text>
        $(function () {
            $('.table').footable();
            initCharts();
        });
            </text>
        }
        @if (Model.MediaType.CallIndex=="weixin")
        {
            <text>
        $(function () {
            if(!$('#myCanvas').tagcanvas({
                textColour: '#1c84c6',
                outlineColour: '#1c84c6',
                reverse: true,
                textHeight: 25,
                depth: 0.8,
                maxSpeed: 0.05,
                //zoom:1.5
            },'tags')) {
                // something went wrong, hide the canvas container
                $('#myCanvasContainer').hide();
            }
            if (!$('#myCanvas1').tagcanvas({
                textColour: '#ed5565',
                outlineColour: '#ed5565',
                reverse: true,
                textHeight: 25,
                depth: 0.8,
                maxSpeed: 0.05,
                //zoom:1.5
            }, 'tags1')) {
                // something went wrong, hide the canvas container
                $('#myCanvasContainer1').hide();
            }
        });

        function showArticles(id,kw) {
            $("#modalView").load("@Url.Action("Articles")?id="+id+"&kw="+kw,
                function () {
                    $('#modalView .modal').modal('show');
                });
        }
            </text>
        }


    </script>
}


